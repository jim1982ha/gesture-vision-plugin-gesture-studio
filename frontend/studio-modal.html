<!-- FILE: extensions/plugins/gesture-vision-plugin-gesture-studio/frontend/studio-modal.html -->
<div id="studio-shell" class="modal visible" role="dialog" aria-modal="true" aria-labelledby="studio-header-title-text">
    <div class="modal-content !max-w-6xl h-[90vh]">
        <h3 class="modal-header">
            <span id="studio-header-icon" class="material-icons header-icon"></span>
            <span id="studio-header-title-text" class="header-title" data-translate-key="pluginStudioName"></span>
            <button id="close-studio-btn" class="btn btn-icon header-close-btn" data-translate-key-aria-label="close"></button>
        </h3>
        <div class="modal-scrollable-content p-2 desktop:p-4">
            <div id="studio-content-wrapper" class="flex flex-col desktop:flex-row gap-4 w-full h-full">
                <div id="studio-video-column" class="flex-grow-[2] min-w-0 min-h-[200px] desktop:min-h-0 relative flex">
                    <div id="studio-video-placeholder" class="relative flex-grow flex items-center justify-center bg-background rounded-md overflow-hidden">
                        <div id="live-test-display" class="absolute bottom-2 right-2 z-10 bg-surface/80 text-text-primary p-2 rounded-md shadow-lg text-xs leading-tight backdrop-blur-sm hidden">
                            <div><span data-translate-key="studioLiveStatus"></span>: <strong id="live-detected-status"></strong></div>
                            <div><span data-translate-key="studioLiveConfidence"></span>: <span id="live-confidence-value"></span></div>
                            <div><span data-translate-key="studioRequiredConfidenceLabel"></span>: <span id="live-required-confidence-value"></span></div>
                        </div>
                        <div id="countdown-overlay" class="absolute inset-0 bg-black/50 flex items-center justify-center pointer-events-none rounded-md">
                            <span id="countdown-overlay-text" class="text-white text-7xl desktop:text-9xl font-bold [text-shadow:_0_0_20px_black] animate-pulse">3</span>
                        </div>
                    </div>
                </div>
                <div id="studio-controls-column" class="flex-grow min-w-[320px] flex flex-col">
                    <div class="bg-surface border border-border rounded-lg shadow-sm p-3 flex flex-col h-full">
                        <div class="flex items-center gap-2 mb-2">
                            <span id="studio-step-icon" class="material-icons text-primary text-xl"></span>
                            <span id="studio-step-title" class="text-base font-semibold text-text-primary" data-translate-key="studioStepDefineTitle"></span>
                        </div>
                        <div class="flex-grow min-h-0 flex flex-col">
                            <section id="define-section" class="flex flex-col justify-between h-full">
                                <!-- FIX: Add 'flex flex-col gap-3' for consistent spacing -->
                                <div class="flex flex-col gap-3">
                                    <div class="form-group !mb-0"><label id="label-gesture-name" for="gesture-name" class="form-label" data-translate-key="studioGestureName"></label><input type="text" id="gesture-name" class="form-control" data-translate-key-placeholder="studioGestureNamePlaceholder"></div>
                                    <div class="form-group !mb-0"><label id="label-gesture-description" for="gesture-description" class="form-label" data-translate-key="studioGestureDesc"></label><textarea id="gesture-description" class="form-control" rows="2" data-translate-key-placeholder="studioGestureDescPlaceholder"></textarea></div>
                                    <div class="form-row"><div class="form-group !mb-0"><label id="label-gesture-type" for="gesture-type" class="form-label" data-translate-key="studioGestureType"></label><select id="gesture-type" class="form-control"><option id="option-gesture-type-hand" value="hand" data-translate-key="studioGestureTypeHand"></option><option id="option-gesture-type-pose" value="pose" data-translate-key="studioGestureTypePose"></option></select></div><div class="form-group !mb-0"><label id="label-samples-to-record" for="samples-to-record" class="form-label" data-translate-key="studioSamplesToRecord"></label><input type="number" id="samples-to-record" class="form-control" value="3" min="3" max="10"></div></div>
                                    <div class="form-group !mb-0"><label id="label-camera-source" for="studio-camera-select" class="form-label" data-translate-key="selectCameraSource"></label><select id="studio-camera-select" class="form-control"></select></div>
                                </div>
                                <div class="flex justify-between items-center mt-auto">
                                    <div></div>
                                    <button id="confirm-setup-start-camera-btn" class="btn btn-primary"><span class="material-icons"></span><span id="btn-text-confirm-setup" data-translate-key="studioConfirmAndStart"></span></button>
                                </div>
                            </section>
                            <section id="record-section" class="h-full flex flex-col gap-3 justify-center">
                                <p id="samples-counter-display"></p>
                                <div id="samples-preview" class="flex-grow-0 min-h-[110px] bg-background border border-border rounded-md p-2 flex flex-wrap justify-center content-start items-center gap-1 overflow-y-auto"></div>
                                <div class="flex justify-between items-center mt-auto">
                                    <button id="back-to-setup-btn-from-record" class="btn btn-secondary"><span class="material-icons"></span><span data-translate-key="studioStartOver"></span></button>
                                    <div class="flex gap-2">
                                        <button id="reset-samples-btn" class="btn btn-secondary"><span class="material-icons"></span><span id="btn-text-reset-samples" data-translate-key="studioResetSamples"></span></button>
                                        <button id="record-workflow-btn" class="btn btn-primary"><span class="material-icons"></span><span id="record-workflow-btn-text" data-translate-key="studioRecordSample"></span></button>
                                    </div>
                                </div>
                            </section>
                            <section id="test-section" class="h-full flex flex-col gap-3 justify-between">
                                <div class="form-group !mb-0"><label for="gestureToleranceSlider" id="label-gesture-tolerance" class="form-label" data-translate-key="studioToleranceLabel"></label><div class="slider-group"><output for="gestureToleranceSlider" id="gestureToleranceValue" class="slider-output">20%</output><div class="slider-container"><input type="range" id="gestureToleranceSlider" class="form-slider" min="0" max="1" step="0.05" value="0.2"></div></div></div>
                                <details id="analysis-details-container" class="border border-border-light rounded p-2"><summary class="cursor-pointer font-medium flex items-center gap-1 list-none"><span class="material-icons"></span> <span data-translate-key="studioAnalysis"></span></summary><p id="analysis-status" class="mt-2"></p><pre id="extracted-features-display" class="text-xs font-mono bg-background border border-border rounded p-2 mt-2 min-h-[100px] max-h-[150px] overflow-auto whitespace-pre-wrap"></pre></details>
                                <details id="generated-code-details-container" class="border border-border-light rounded p-2" open><summary class="cursor-pointer font-medium flex items-center gap-1 list-none"><span class="material-icons"></span> <span data-translate-key="studioGeneratedJS"></span></summary><div class="mt-2"><textarea id="generated-code" class="form-control text-xs font-mono !bg-background" rows="15" readonly></textarea></div></details>
                                <div id="test-controls-group" class="flex justify-between items-center mt-auto">
                                    <button id="back-to-setup-btn" class="btn btn-secondary"><span class="material-icons"></span><span id="btn-text-back-to-setup" data-translate-key="studioStartOver"></span></button>
                                    <button id="save-gesture-btn" class="btn btn-primary"><span class="material-icons"></span><span id="btn-text-save-gesture" data-translate-key="studioSaveGesture"></span></button>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>